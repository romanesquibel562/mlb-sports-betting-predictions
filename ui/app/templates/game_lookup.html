{% extends "base.html" %}

{% block content %}

<div class="page-title">Game Lookup</div>
<div class="subtitle">
  Search games by date or team name, then open the full Game Hub for that matchup.
</div>

<section class="card">
  <div class="top-bar">
    <h2 style="font-size: 1rem; margin: 0;">All Matchups</h2>
    <div>
      <input id="search" class="search-input" type="text"
             placeholder="Search by team, matchup, or date (YYYY-MM-DD)â€¦">
    </div>
  </div>

  {% if games %}
  <div class="table-wrap">
    <table id="games-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Matchup</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {% for g in games %}
        <tr>
          <td class="game-date">{{ g.game_date }}</td>
          <td class="matchup-cell game-matchup">
            {{ g.away_team }} @ {{ g.home_team }}
          </td>
          <td>
            <a class="btn-link"
               href="{{ url_for('ui.game_detail', date_str=g.game_date, away=g.away_team, home=g.home_team) }}">
              View Analysis
            </a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p>No games found. Generate some <code>main_features_*.csv</code> files first.</p>
  {% endif %}
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const input = document.getElementById("search");
  const rows = Array.from(document.querySelectorAll("#games-table tbody tr"));

  input.addEventListener("input", () => {
    const q = input.value.toLowerCase();
    rows.forEach(row => {
      const date = row.querySelector(".game-date").textContent.toLowerCase();
      const matchup = row.querySelector(".game-matchup").textContent.toLowerCase();
      const visible = date.includes(q) || matchup.includes(q);
      row.style.display = visible ? "" : "none";
    });
  });
});
</script>

{% endblock %}